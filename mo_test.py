import os
import requests

# Put your API key in the environment (recommended)
API_KEY = "eyJ4NXQjUzI1NiI6Ik5XVTVZakUxTkRjeVl6a3hZbUl4TkdSaFpqSmpOV1l6T1dGaE9XWXpNMk0yTWpRek5USm1OVEE0TXpOaU9EaG1NVFJqWVdNellXUm1ZalUyTTJJeVpBPT0iLCJraWQiOiJnYXRld2F5X2NlcnRpZmljYXRlX2FsaWFzIiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ==.eyJzdWIiOiJsaWFtLmZhcnJhckBsaXZlLmNvLnVrQGNhcmJvbi5zdXBlciIsImFwcGxpY2F0aW9uIjp7Im93bmVyIjoibGlhbS5mYXJyYXJAbGl2ZS5jby51ayIsInRpZXJRdW90YVR5cGUiOm51bGwsInRpZXIiOiJVbmxpbWl0ZWQiLCJuYW1lIjoic2l0ZV9zcGVjaWZpYy01NTA5ZTI4NS0xYzczLTQ2MjUtYTk0YS05YWEyZmQyZTZkYjAiLCJpZCI6MzgyOTYsInV1aWQiOiIyNTFhMzEwMS01ZDI1LTQ3OTctODY5YS02MmQ2MjJmMTg1OGQifSwiaXNzIjoiaHR0cHM6XC9cL2FwaS1tYW5hZ2VyLmFwaS1tYW5hZ2VtZW50Lm1ldG9mZmljZS5jbG91ZDo0NDNcL29hdXRoMlwvdG9rZW4iLCJ0aWVySW5mbyI6eyJ3ZGhfc2l0ZV9zcGVjaWZpY19mcmVlIjp7InRpZXJRdW90YVR5cGUiOiJyZXF1ZXN0Q291bnQiLCJncmFwaFFMTWF4Q29tcGxleGl0eSI6MCwiZ3JhcGhRTE1heERlcHRoIjowLCJzdG9wT25RdW90YVJlYWNoIjp0cnVlLCJzcGlrZUFycmVzdExpbWl0IjowLCJzcGlrZUFycmVzdFVuaXQiOiJzZWMifX0sImtleXR5cGUiOiJQUk9EVUNUSU9OIiwic3Vic2NyaWJlZEFQSXMiOlt7InN1YnNjcmliZXJUZW5hbnREb21haW4iOiJjYXJib24uc3VwZXIiLCJuYW1lIjoiU2l0ZVNwZWNpZmljRm9yZWNhc3QiLCJjb250ZXh0IjoiXC9zaXRlc3BlY2lmaWNcL3YwIiwicHVibGlzaGVyIjoiSmFndWFyX0NJIiwidmVyc2lvbiI6InYwIiwic3Vic2NyaXB0aW9uVGllciI6IndkaF9zaXRlX3NwZWNpZmljX2ZyZWUifV0sInRva2VuX3R5cGUiOiJhcGlLZXkiLCJpYXQiOjE3NzA0MTQzMjEsImp0aSI6ImI3ZmY3NDA1LWQzNGQtNDFlZS04NTY0LTU1MzRmZTY0ODFiMCJ9.X-z8PD9c9PVvPykobW7gLtrQTOCh62opIJnQPFCsE9lLyLok3jjbSKnntVcO49sys17jGq5mmk3iTkUnkcCvHcMDO-QDbzjiMyQwDaxE-yCmIrPEgUltEEuDnuRWCWjMS4Ri8gYWKTeHpumK0Y0PFqFuf3NJbrvFwtTLlcLlDzjlPVdWYllBOfEig7fpD6buoHr76FM6SjURKjoJsWvF188QpSiLIsySGNJHSNsaYLcNq83nRwdQk4p2r3FSD8pOOUBXB9ZrtWNU7NvHtAKAQE4pzOHGaFrsXymJ_qIQgWFPkQZ_6n8vjlxEWlQyHt7L1NJxqB82JAA9GnhmfSbUEg=="

if not API_KEY:
    raise RuntimeError("OPEN_WEATHER_MAP_SECRET is not set")

BASE_URL = "https://data.hub.api.metoffice.gov.uk/sitespecific/v0/point/hourly"

params = {
    "latitude": 51.357,
    "longitude": -2.364,
    "excludeParameterMetadata": "FALSE",
    "includeLocationName": "TRUE",
}

headers = {
    "accept": "application/json",
    "apikey": API_KEY,
}

response = requests.get(BASE_URL, params=params, headers=headers, timeout=20)

print("Status code:", response.status_code)
print()
print(response.text)
